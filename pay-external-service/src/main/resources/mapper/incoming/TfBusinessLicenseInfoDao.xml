<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tfjt.pay.external.unionpay.dao.TfBusinessLicenseInfoDao">


    <select id="queryBusinessById"
            resultType="com.tfjt.pay.external.unionpay.dto.resp.IncomingBusinessRespDTO">
        select a.id,a.business_license_id,a.email, b.business_name, b.business_province, b.business_province_name, b.business_city,
        b.business_city_name, b.business_district, b.business_district_name, b.business_license_no, b.business_license_url,
        b.business_license_effective_date, b.business_license_expire_date, b.business_license_is_long_term
        from tf_incoming_business_info a
        left join tf_business_license_info b on a.business_license_id = b.id
        where a.id = #{id};
    </select>

    <select id="queryCountByLicenseNo" resultType="java.lang.Integer">
        select count(a.id)
        from tf_business_license_info a
        left join tf_incoming_business_info b on b.business_license_id = a.id
        left join tf_incoming_info c on b.incoming_id = c.id
        where a.is_deleted = 0 and a.business_license_no = #{incomingBusiness.businessLicenseNo}
        and c.id != #{incomingBusiness.incomingId} and c.access_status != 12
    </select>
</mapper>