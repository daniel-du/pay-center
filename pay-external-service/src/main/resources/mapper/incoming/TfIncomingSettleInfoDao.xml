<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tfjt.pay.external.unionpay.dao.TfIncomingSettleInfoDao">


    <select id="querySettleById"
            resultType="com.tfjt.pay.external.unionpay.dto.resp.IncomingSettleRespDTO">
        select a.id, a.bank_card_id, a.settlement_account_type, a.occupation, b.bank_account_name, b.bank_card_no,
        b.bank_card_mobile, b.bank_card_url, b.bank_name, b.bank_sub_branch_name, b.bank_branch_code,b.eicon_bank_branch,
        b.open_account_province, b.open_account_province_name, b.open_account_city, b.open_account_city_name,
        b.open_account_district, b.open_account_district_name, b.bank_code
        from tf_incoming_settle_info a
        left join tf_bank_card_info b on a.bank_card_id = b.id  and b.is_deleted = 0
        where a.id = #{id}  and a.is_deleted = 0;
    </select>
    <select id="querySettleByMerchant"
            resultType="com.tfjt.pay.external.unionpay.dto.resp.IncomingSettleRespDTO">
        select a.id, a.incoming_id, a.bank_card_id, a.settlement_account_type, a.occupation, b.bank_account_name, b.bank_card_no,
        b.bank_card_mobile, b.bank_card_url, b.bank_name, b.bank_sub_branch_name, b.bank_branch_code,b.eicon_bank_branch,
        b.open_account_province, b.open_account_province_name, b.open_account_city, b.open_account_city_name,
        b.open_account_district, b.open_account_district_name, b.bank_code
        from tf_incoming_settle_info a
        left join tf_bank_card_info b on a.bank_card_id = b.id  and b.is_deleted = 0
        left join tf_incoming_info c on a.incoming_id  = c.id and c.is_deleted = 0
        where c.business_id = #{req.businessId} and c.business_type = #{req.businessType}
        and c.access_channel_type = #{req.accessChannelType} and a.is_deleted = 0;
    </select>
</mapper>