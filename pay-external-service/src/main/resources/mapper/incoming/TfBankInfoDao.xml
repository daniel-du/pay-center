<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tfjt.pay.external.unionpay.dao.TfBankCardInfoDao">


    <select id="queryCountByBankNo" resultType="java.lang.Integer">
        select count(a.id)
        from tf_bank_card_info  a
        left join tf_incoming_settle_info b on b.bank_card_id  = a.id
        left join tf_incoming_info c on b.incoming_id = c.id
        where a.is_deleted = 0 and a.bank_card_no = #{incomingSettle.bankCardNo}
        and c.id != #{incomingSettle.incomingId} and c.access_status != 12
    </select>
</mapper>